; XDL Unit Tests for Control Flow Constructs
; Focused tests for parser and interpreter validation

; =============================================================================
; SIMPLE IF STATEMENT TESTS
; =============================================================================

; Test 1: Basic if-then
if 1 then
  print, "Test 1 PASS: Basic if-then"
endif

; Test 2: Basic if-then-else  
if 0 then begin
  print, "Test 2 FAIL: Should not execute"
end else begin
  print, "Test 2 PASS: Basic if-then-else"
end
endif

; Test 3: If with comparison
x = 42
if x eq 42 then
  print, "Test 3 PASS: If with EQ comparison"
endif

; =============================================================================
; SIMPLE FOR LOOP TESTS
; =============================================================================

; Test 4: Basic for loop
print, "Test 4: Basic for loop results:"
for i = 1, 3
  print, "  Loop iteration:", i
endfor

; Test 5: For loop with negative step (should be implemented)
print, "Test 5: For loop with step:"
for i = 0, 6, 2
  print, "  Step loop:", i
endfor

; =============================================================================
; SIMPLE WHILE LOOP TESTS  
; =============================================================================

; Test 6: Basic while loop
print, "Test 6: Basic while loop:"
counter = 3
while counter gt 0
  print, "  While counter:", counter
  counter = counter - 1
endwhile

; =============================================================================
; BREAK AND CONTINUE TESTS
; =============================================================================

; Test 7: Break in for loop
print, "Test 7: Break statement:"
for i = 1, 10
  if i eq 4 then
    print, "  Breaking at i =", i
    break
  endif
  print, "  Before break:", i
endfor

; Test 8: Continue in for loop
print, "Test 8: Continue statement:"
for i = 1, 5
  if i eq 3 then
    print, "  Skipping i =", i
    continue
  endif
  print, "  Not skipped:", i
endfor

; =============================================================================
; NESTED CONTROL FLOW TESTS
; =============================================================================

; Test 9: Nested if statements
print, "Test 9: Nested if statements:"
a = 5
b = 3
if a gt 0 then
  print, "  a is positive"
  if b gt 0 then
    print, "  b is also positive"
    if a gt b then
      print, "  a > b"
    endif
  endif
endif

; Test 10: Nested loops
print, "Test 10: Nested loops (2x2 grid):"
for row = 1, 2
  for col = 1, 2
    print, "  Position (", row, ",", col, ")"
  endfor
endfor

; =============================================================================
; COMPARISON OPERATOR TESTS
; =============================================================================

print, "Test 11: All comparison operators:"
val1 = 10
val2 = 20

; EQ test
if val1 eq 10 then print, "  EQ works: val1 == 10"

; NE test  
if val1 ne val2 then print, "  NE works: val1 != val2"

; LT test
if val1 lt val2 then print, "  LT works: val1 < val2"

; GT test
if val2 gt val1 then print, "  GT works: val2 > val1"

; LE test
if val1 le 10 then print, "  LE works: val1 <= 10"

; GE test
if val2 ge 20 then print, "  GE works: val2 >= 20"

; =============================================================================
; LOGICAL OPERATOR TESTS
; =============================================================================

print, "Test 12: Logical operators:"
true_val = 1
false_val = 0

; AND test
if true_val and true_val then print, "  AND works: true AND true"

; OR test  
if true_val or false_val then print, "  OR works: true OR false"

; NOT test
if not false_val then print, "  NOT works: NOT false"

; =============================================================================
; VARIABLE SCOPING TESTS
; =============================================================================

print, "Test 13: Variable scoping in loops:"
global_var = 100

for i = 1, 2
  local_var = i * 10
  global_var = global_var + i
  print, "  Loop", i, ": local_var =", local_var, ", global_var =", global_var
endfor

print, "  After loop: global_var =", global_var

; =============================================================================
; ARITHMETIC IN CONDITIONS TESTS
; =============================================================================

print, "Test 14: Arithmetic expressions in conditions:"
x = 5
y = 3

if x + y eq 8 then print, "  Addition in condition works"
if x * y eq 15 then print, "  Multiplication in condition works"  
if x - y eq 2 then print, "  Subtraction in condition works"
if x / y gt 1 then print, "  Division in condition works"

print, "=== UNIT TESTS COMPLETED ==="