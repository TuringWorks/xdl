; Test interpolation functions
; INTERPOL, SPLINE, BILINEAR

PRINT, '=== Testing Interpolation Functions ==='

; Create sample data
PRINT, ''
PRINT, '--- Sample Data ---'
x = [0.0, 1.0, 2.0, 3.0, 4.0, 5.0]
y = [0.0, 1.0, 4.0, 9.0, 16.0, 25.0]  ; y = x^2
PRINT, 'x = ', x
PRINT, 'y = ', y, ' (y = x^2)'

; Test INTERPOL (linear interpolation)
PRINT, ''
PRINT, '--- INTERPOL ---'
; Interpolate to finer grid
x_new = [0.0, 0.5, 1.0, 1.5, 2.0, 2.5, 3.0, 3.5, 4.0, 4.5, 5.0]
y_interp = INTERPOL(y, x, x_new)
PRINT, 'x_new = ', x_new
PRINT, 'INTERPOL(y, x, x_new) = ', y_interp

; Compare with exact values
y_exact = x_new * x_new
PRINT, 'Exact y = x^2: ', y_exact
PRINT, 'Error: ', y_interp - y_exact

; Test SPLINE (cubic spline interpolation)
PRINT, ''
PRINT, '--- SPLINE ---'
y_spline = SPLINE(x, y, x_new)
PRINT, 'SPLINE(x, y, x_new) = ', y_spline
PRINT, 'Error vs exact: ', y_spline - y_exact

; Sine function test (spline should be more accurate)
PRINT, ''
PRINT, '--- Sine function test ---'
x_sin = [0.0, 0.5, 1.0, 1.5, 2.0, 2.5, 3.0]
y_sin = SIN(x_sin)
PRINT, 'x_sin = ', x_sin
PRINT, 'y_sin = SIN(x_sin) = ', y_sin

x_sin_new = [0.0, 0.25, 0.5, 0.75, 1.0, 1.25, 1.5, 1.75, 2.0, 2.25, 2.5, 2.75, 3.0]
y_sin_interp = INTERPOL(y_sin, x_sin, x_sin_new)
y_sin_spline = SPLINE(x_sin, y_sin, x_sin_new)
y_sin_exact = SIN(x_sin_new)

PRINT, ''
PRINT, 'At x = 0.25:'
PRINT, '  Linear interp: ', y_sin_interp[1]
PRINT, '  Spline interp: ', y_sin_spline[1]
PRINT, '  Exact value:   ', y_sin_exact[1]

PRINT, ''
PRINT, 'At x = 1.25:'
PRINT, '  Linear interp: ', y_sin_interp[5]
PRINT, '  Spline interp: ', y_sin_spline[5]
PRINT, '  Exact value:   ', y_sin_exact[5]

; Test BILINEAR (2D interpolation)
PRINT, ''
PRINT, '--- BILINEAR ---'
; Note: BILINEAR requires MultiDimArray format which may not work with literal 2D arrays
; Skipping test - function implemented but requires proper 2D array support
PRINT, 'BILINEAR: Requires MultiDimArray format (REFORM/FLTARR)'

PRINT, ''
PRINT, '=== Interpolation tests complete ==='
