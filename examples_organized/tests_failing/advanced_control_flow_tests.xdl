; XDL Advanced Control Flow Test Suite
; Basic algorithms and patterns using control flow constructs

print, "=== XDL ADVANCED CONTROL FLOW PATTERNS ==="
print, ""

; Binary search implementation
print, "Binary Search Algorithm:"
arr = [1, 3, 5, 7, 9, 11, 13, 15, 17, 19]
target = 7
found = 0
found_index = -1

low = 0
high = n_elements(arr) - 1

while low le high do begin
  mid = (low + high) / 2

  if arr[mid] eq target then
    found = 1
    found_index = mid
    low = high + 1  ; Exit loop

  if arr[mid] lt target then
    low = mid + 1

  if arr[mid] gt target then
    high = mid - 1
end
endwhile

if found then
  print, "  Found", target, "at index", found_index
else
  print, "  ", target, "not found in array"
endif

print, ""

; Greatest Common Divisor (Euclidean Algorithm)
print, "Greatest Common Divisor (GCD):"
a = 48
b = 18

print, "  Finding GCD of", a, "and", b

while b ne 0 do begin
  temp = b
  b = a mod b
  a = temp
end
endwhile

print, "  GCD =", a

print, ""

; Factorial calculation
print, "Factorial Calculation:"
n = 6
factorial = 1
i = 1

while i le n do begin
  factorial = factorial * i
  i = i + 1
end
endwhile

print, "  ", n, "! =", factorial

print, ""

; Safe division with error checking
print, "Safe Division Function:"
dividends = [10, 15, 20, 25]
divisors = [2, 0, 4, 5]

for i = 0, 3
  dividend = dividends[i]
  divisor = divisors[i]

  if divisor eq 0 then begin
    print, "  Error: Division by zero for", dividend, "/", divisor
  endif

  if divisor ne 0 then begin
    result = dividend / divisor
    print, "  ", dividend, "/", divisor, "=", result
  endif
endfor

print, ""
print, "=== ADVANCED CONTROL FLOW TESTS COMPLETED ==="
